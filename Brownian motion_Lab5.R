#5 –õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞—è —Ä–∞–±–æ—Ç–∞: –±—Ä–æ—É–Ω–æ–≤—Å–∫–æ–µ –¥–≤–∏–∂–µ–Ω–∏–µ
## –ó–∞–º–æ–¥–µ–ª–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ—Ü–µ—Å—Å (8) –¥–ª—è ‚àÜ = 0.0001 (—Ç.–µ. —Å—Ä–µ–¥–Ω–µ-–∫–≤–∞–¥—Ä–∞—Ç–∏—á–µ—Å–∫–æ–µ)
Brownian = function(n, B0, d) {
  Brownian = numeric(n)  # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –≤–µ–∫—Ç–æ—Ä –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –∑–Ω–∞—á–µ–Ω–∏–π –±—Ä–æ—É–Ω–æ–≤—Å–∫–æ–≥–æ –¥–≤–∏–∂–µ–Ω–∏—è
  k = numeric(n)         # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –≤–µ–∫—Ç–æ—Ä –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π
  Brownian[1] = B0       # –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –Ω–∞—á–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –±—Ä–æ—É–Ω–æ–≤—Å–∫–æ–≥–æ –¥–≤–∏–∂–µ–Ω–∏—è
  k[1] = d               # –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –Ω–∞—á–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏
  
  # –¶–∏–∫–ª –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∑–Ω–∞—á–µ–Ω–∏–π –ø—Ä–æ—Ü–µ—Å—Å–∞
  for (i in 2:n) {
    e = rnorm(1, 0, sqrt(d))  # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –Ω–æ—Ä–º–∞–ª—å–Ω–æ–µ —Å–ª—É—á–∞–π–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ —Å –Ω—É–ª–µ–≤—ã–º —Å—Ä–µ–¥–Ω–∏–º –∏ –¥–∏—Å–ø–µ—Ä—Å–∏–µ–π d
    Brownian[i] = Brownian[i - 1] + e  # –û–±–Ω–æ–≤–ª—è–µ–º —Ç–µ–∫—É—â–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –±—Ä–æ—É–Ω–æ–≤—Å–∫–æ–≥–æ –¥–≤–∏–∂–µ–Ω–∏—è
    k[i] = i * d              # –û–±–Ω–æ–≤–ª—è–µ–º –≤—Ä–µ–º–µ–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
  }
  return(data.frame(Brownian, k))  # –í–æ–∑–≤—Ä–∞—â–∞–µ–º –¥–∞—Ç–∞-—Ñ—Ä–µ–π–º —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏
}

n = 1000               # –ó–∞–¥–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —à–∞–≥–æ–≤ (n)
d = 0.0001            # –ó–∞–¥–∞–µ–º –∑–Ω–∞—á–µ–Ω–∏–µ –¥–∏—Å–ø–µ—Ä—Å–∏–∏ (d)
B0 = 0                 # –ù–∞—á–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –±—Ä–æ—É–Ω–æ–≤—Å–∫–æ–≥–æ –¥–≤–∏–∂–µ–Ω–∏—è (B0)
B = Brownian(n, B0, d)  # –í—ã–∑—ã–≤–∞–µ–º —Ñ—É–Ω–∫—Ü–∏—é –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –ø—Ä–æ—Ü–µ—Å—Å–∞

# –°—Ç—Ä–æ–∏–º –≥—Ä–∞—Ñ–∏–∫ –±—Ä–æ—É–Ω–æ–≤—Å–∫–æ–≥–æ –¥–≤–∏–∂–µ–Ω–∏—è
plot(B$k, B$Brownian, type = "l", col = "cyan", ylim = c(-2, 2))

## –ü–æ—Å—Ç—Ä–æ–∏—Ç—å –∞–Ω—Å–∞–º–±–ª—å —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–π –ø—Ä–æ—Ü–µ—Å—Å–∞, –∑–∞–º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –Ω–∞ –ø—Ä–µ–¥—ã–¥—É—â–µ–º —à–∞–≥–µ,
## –∏ –≤—ã–≤–µ—Å—Ç–∏ –≤—Å–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –ø—Ä–æ—Ü–µ—Å—Å–∞ –Ω–∞ –æ–¥–∏–Ω –≥—Ä–∞—Ñ–∏–∫. 
## –¢.–µ. –ø–æ—Å—Ç—Ä–æ–∏—Ç—å 200 —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–π –ø—Ä–æ—Ü–µ—Å—Å–∞ (8) –Ω–∞ –æ–¥–Ω–æ–º –≥—Ä–∞—Ñ–∏–∫–µ.

for (i in 1:199) {  # –¶–∏–∫–ª –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ 199 –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–π
  B = Brownian(n, B0, d)  # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –Ω–æ–≤—É—é —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é –±—Ä–æ—É–Ω–æ–≤—Å–∫–æ–≥–æ –¥–≤–∏–∂–µ–Ω–∏—è
  lines(B$k, B$Brownian, type = "l", col = "cyan")  # –î–æ–±–∞–≤–ª—è–µ–º –ª–∏–Ω–∏—é –Ω–∞ –≥—Ä–∞—Ñ–∏–∫
}

## –û–≥—Ä–∞–Ω–∏—á–∏—Ç—å –∞–Ω—Å–∞–º–±–ª—å —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–π, –ø–æ—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –Ω–∞ –ø—Ä–µ–¥—ã–¥—É—â–µ–º —à–∞–≥–µ –ø–æ –ø—Ä–∞–≤–∏–ª—É —Ç—Ä–µ—Ö —Å–∏–≥–º.
lines(B$k, 3 * sqrt(B$k), col = "magenta", type = "l", lwd = 2)  # –î–æ–±–∞–≤–ª—è–µ–º –≤–µ—Ä—Ö–Ω—é—é –≥—Ä–∞–Ω–∏—Ü—É (3 —Å–∏–≥–º—ã)
lines(B$k, -3 * sqrt(B$k), col = "magenta", type = "l", lwd = 2) # –î–æ–±–∞–≤–ª—è–µ–º –Ω–∏–∂–Ω—é—é –≥—Ä–∞–Ω–∏—Ü—É (3 —Å–∏–≥–º—ã)

## –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –ø—Ä–æ—Ü–µ—Å—Å (9) –ø—Ä–∏ —Å–ª–µ–¥—É—é—â–∏—Ö –≤—Ö–æ–¥–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏—è—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤:
## ùëÜ0 = 1, ùëé = 0.5, ùúé = 0.9, ‚àö‚àÜ = 0.01, ùëò = 0, 1, . . . , 103.

S = function(n, d, a, sigma, S0, B0) {
  S = numeric(n)        # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –≤–µ–∫—Ç–æ—Ä –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –∑–Ω–∞—á–µ–Ω–∏–π –ø—Ä–æ—Ü–µ—Å—Å–∞ S
  B = Brownian(n, B0, d)  # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –±—Ä–æ—É–Ω–æ–≤—Å–∫–æ–µ –¥–≤–∏–∂–µ–Ω–∏–µ
  k = B$k               # –ò–∑–≤–ª–µ–∫–∞–µ–º –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –∏–∑ –±—Ä–æ—É–Ω–æ–≤—Å–∫–æ–≥–æ –¥–≤–∏–∂–µ–Ω–∏—è
  S[1] = S0             # –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –Ω–∞—á–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ S0
  
  # –¶–∏–∫–ª –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ –∑–Ω–∞—á–µ–Ω–∏–π –ø—Ä–æ—Ü–µ—Å—Å–∞ S
  for (i in 2:n) {
    # –í—ã—á–∏—Å–ª—è–µ–º —Ç–µ–∫—É—â–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ S –ø–æ —Ñ–æ—Ä–º—É–ª–µ
    S[i] = S0 * exp((a - (sigma^2) / 2) * i * d + sigma * B$Brownian[i])
  }
  return(data.frame(S, k))  # –í–æ–∑–≤—Ä–∞—â–∞–µ–º –¥–∞—Ç–∞-—Ñ—Ä–µ–π–º —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏
}

n = 1000               # –ó–∞–¥–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —à–∞–≥–æ–≤ (n)
S0 = 1                 # –ù–∞—á–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ S0
B0 = 0                 # –ù–∞—á–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –±—Ä–æ—É–Ω–æ–≤—Å–∫–æ–≥–æ –¥–≤–∏–∂–µ–Ω–∏—è (B0)
a = 0.5                # –ü–∞—Ä–∞–º–µ—Ç—Ä a
d = 0.0001             # –ó–Ω–∞—á–µ–Ω–∏–µ –¥–∏—Å–ø–µ—Ä—Å–∏–∏ (d)
sigma = 0.9            # –ü–∞—Ä–∞–º–µ—Ç—Ä –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏ (sigma)

s = S(n, d, a, sigma, S0, B0)  # –í—ã–∑—ã–≤–∞–µ–º —Ñ—É–Ω–∫—Ü–∏—é –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –ø—Ä–æ—Ü–µ—Å—Å–∞ S

# –°—Ç—Ä–æ–∏–º –≥—Ä–∞—Ñ–∏–∫ –ø—Ä–æ—Ü–µ—Å—Å–∞ S
plot(s$k, s$S, type = "l", col = "cyan", ylim = c(0, 3))

## –ü–æ—Å—Ç—Ä–æ–∏—Ç—å 200 —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–π –ø—Ä–æ—Ü–µ—Å—Å–∞ (10) –Ω–∞ –æ–¥–Ω–æ–º –≥—Ä–∞—Ñ–∏–∫–µ.
for (i in 1:199) {  # –¶–∏–∫–ª –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ 199 –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–π
  s = S(n, d, a, sigma, S0, B0)  # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –Ω–æ–≤—É—é —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é –ø—Ä–æ—Ü–µ—Å—Å–∞ S
  lines(s$k, s$S, type = "l", col = "cyan")  # –î–æ–±–∞–≤–ª—è–µ–º –ª–∏–Ω–∏—é –Ω–∞ –≥—Ä–∞—Ñ–∏–∫
}

