#6 –õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞—è —Ä–∞–±–æ—Ç–∞: –æ—Ü–µ–Ω–∏–≤–∞–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –≥–µ–æ–º–µ—Ç—Ä–∏—á–µ—Å–∫–æ–≥–æ –±—Ä–æ—É–Ω–æ–≤—Å–∫–æ–≥–æ –¥–≤–∏–∂–µ–Ω–∏—è

#1 –ó–∞–º–æ–¥–µ–ª–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ—Ü–µ—Å—Å (10) –¥–ª—è ùëÜ0 = 100, ùëé = 0.5, ùúé = 0.8,
#‚àö‚àÜ = 0.01,ùëò = 0, 1, . . . , 10^3
## –ó–∞–¥–∞–Ω–∏–µ ‚Ññ1
S0 = 100
a = 0.5
sigma = 0.8
delta = 0.0001
n = 1000
B0 = 0
B = function(delta, n, B0) {
  # –§—É–Ω–∫—Ü–∏—è –¥–ª—è –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏—è –±—Ä–æ—É–Ω–æ–≤—Å–∫–æ–≥–æ –¥–≤–∏–∂–µ–Ω–∏—è
  # delta - —à–∞–≥ –ø–æ –≤—Ä–µ–º–µ–Ω–∏
  # n - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —à–∞–≥–æ–≤
  # B0 - –Ω–∞—á–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –±—Ä–æ—É–Ω–æ–≤—Å–∫–æ–≥–æ –¥–≤–∏–∂–µ–Ω–∏—è
  
  B = c(B0)  # –°–æ–∑–¥–∞–µ–º –≤–µ–∫—Ç–æ—Ä –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –∑–Ω–∞—á–µ–Ω–∏–π –±—Ä–æ—É–Ω–æ–≤—Å–∫–æ–≥–æ –¥–≤–∏–∂–µ–Ω–∏—è, –Ω–∞—á–∏–Ω–∞—è —Å B0
  k_delta = c(delta)  # –°–æ–∑–¥–∞–µ–º –≤–µ–∫—Ç–æ—Ä –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —à–∞–≥–æ–≤, –Ω–∞—á–∏–Ω–∞—è —Å delta
  
  for(k in 2:n) {
    # –¶–∏–∫–ª –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∑–Ω–∞—á–µ–Ω–∏–π –±—Ä–æ—É–Ω–æ–≤—Å–∫–æ–≥–æ –¥–≤–∏–∂–µ–Ω–∏—è
    e = rnorm(1, 0, sqrt(delta))  # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Å–ª—É—á–∞–π–Ω—ã–π –ø—Ä–∏—Ä–æ—Å—Ç –±—Ä–æ—É–Ω–æ–≤—Å–∫–æ–≥–æ –¥–≤–∏–∂–µ–Ω–∏—è
    B = c(B, B[k-1] + e)  # –î–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –±—Ä–æ—É–Ω–æ–≤—Å–∫–æ–≥–æ –¥–≤–∏–∂–µ–Ω–∏—è
    k_delta = c(k_delta, k*delta)  # –î–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤—ã–π –≤—Ä–µ–º–µ–Ω–Ω–æ–π —à–∞–≥
  }
  
  return(data.frame(k_delta, B))  # –í–æ–∑–≤—Ä–∞—â–∞–µ–º data.frame —Å –≤—Ä–µ–º–µ–Ω–Ω—ã–º–∏ —à–∞–≥–∞–º–∏ –∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏ –±—Ä–æ—É–Ω–æ–≤—Å–∫–æ–≥–æ –¥–≤–∏–∂–µ–Ω–∏—è
}

S = function(delta, n, S0, sigma, a, B0) {
  # –§—É–Ω–∫—Ü–∏—è –¥–ª—è –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–æ—Ü–µ—Å—Å–∞ S(t)
  # delta - —à–∞–≥ –ø–æ –≤—Ä–µ–º–µ–Ω–∏
  # n - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —à–∞–≥–æ–≤
  # S0 - –Ω–∞—á–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–∞ S(t)
  # sigma - –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å
  # a - –ø–∞—Ä–∞–º–µ—Ç—Ä —Å–Ω–æ—Å–∞
  # B0 - –Ω–∞—á–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –±—Ä–æ—É–Ω–æ–≤—Å–∫–æ–≥–æ –¥–≤–∏–∂–µ–Ω–∏—è
  
  Brownian = B(delta, n, B0)  # –í—ã–∑—ã–≤–∞–µ–º —Ñ—É–Ω–∫—Ü–∏—é B() –¥–ª—è –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏—è –±—Ä–æ—É–Ω–æ–≤—Å–∫–æ–≥–æ –¥–≤–∏–∂–µ–Ω–∏—è
  S = c(S0)  # –°–æ–∑–¥–∞–µ–º –≤–µ–∫—Ç–æ—Ä –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –∑–Ω–∞—á–µ–Ω–∏–π –ø—Ä–æ—Ü–µ—Å—Å–∞ S(t), –Ω–∞—á–∏–Ω–∞—è —Å S0
  
  for(k in 2:n) {
    # –¶–∏–∫–ª –¥–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –∑–Ω–∞—á–µ–Ω–∏–π –ø—Ä–æ—Ü–µ—Å—Å–∞ S(t)
    ex = (a - (sigma**2)/2)*k*delta + sigma*Brownian$B[k]  # –í—ã—á–∏—Å–ª—è–µ–º —ç–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–π —á–ª–µ–Ω
    S = c(S, S0*exp(ex))  # –î–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–∞ S(t)
  }
  
  return(data.frame(k_d = Brownian$k_delta, S))  # –í–æ–∑–≤—Ä–∞—â–∞–µ–º data.frame —Å –≤—Ä–µ–º–µ–Ω–Ω—ã–º–∏ —à–∞–≥–∞–º–∏ –∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏ –ø—Ä–æ—Ü–µ—Å—Å–∞ S(t)
}

s = S(delta, n, S0, sigma, a, B0)  # –í—ã–∑—ã–≤–∞–µ–º —Ñ—É–Ω–∫—Ü–∏—é S() –¥–ª—è –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–æ—Ü–µ—Å—Å–∞ S(t)

plot(s$k_d,s$S,type = "l",col="pink")

## –ó–∞–¥–∞–Ω–∏–µ ‚Ññ2 
X = c()
for(k in 1:n-1){
  X = c(X,log(s$S[k+1])-log(s$S[k]))
}
mu_est = (1/n)*sum(X)
sigma2_est = (1/n)*sum((X-mu_est)**2)
sigma_est = sqrt(sigma2_est/delta)
sigma_est**2
a_est = (mu_est/delta) + (sigma_est**2)/2;a_est

