#–õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞—è —Ä–∞–±–æ—Ç–∞ 2: GARCH(p, q)
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–∞–∫–µ—Ç–∞ tseries, –µ—Å–ª–∏ –æ–Ω –µ—â–µ –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
install.packages("tseries")

# –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ tseries –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –≤—Ä–µ–º–µ–Ω–Ω—ã–º–∏ —Ä—è–¥–∞–º–∏
library("tseries")

# –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ stats –¥–ª—è —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏—Ö —Ñ—É–Ω–∫—Ü–∏–π
library("stats")

## 1. –ü–æ—Å—Ç—Ä–æ–∏—Ç—å –≥—Ä–∞—Ñ–∏–∫ —Å—Ç–∞—Ü–∏–æ–Ω–∞—Ä–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞ {‚Ñéùëõ} –∏ –≥—Ä–∞—Ñ–∏–∫ –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏
## {ùúéùëõ} –ø—Ä–æ—Ü–µ—Å—Å–∞ GARCH(1,0) –∏–∑ n = 1000 –Ω–∞–±–ª—é–¥–µ–Ω–∏–π.

# –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ GARCH(1,0) –ø—Ä–æ—Ü–µ—Å—Å–∞
garch_1_0 <- function(n, a0, a1) {
  s = numeric(n)  # –í–µ–∫—Ç–æ—Ä –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –∑–Ω–∞—á–µ–Ω–∏–π –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏
  h = numeric(n)  # –í–µ–∫—Ç–æ—Ä –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –∑–Ω–∞—á–µ–Ω–∏–π –ø—Ä–æ—Ü–µ—Å—Å–∞
  e = rnorm(1, 0, 1)  # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø–µ—Ä–≤–æ–π –æ—à–∏–±–∫–∏ –∏–∑ –Ω–æ—Ä–º–∞–ª—å–Ω–æ–≥–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è
  s[1] = runif(1, min = 0, max = 1)  # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø–µ—Ä–≤–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏ —Å–ª—É—á–∞–π–Ω—ã–º —á–∏—Å–ª–æ–º
  h[1] = e * sqrt(s[1])  # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø–µ—Ä–≤–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è –ø—Ä–æ—Ü–µ—Å—Å–∞
  
  # –¶–∏–∫–ª –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –æ—Å—Ç–∞–≤—à–∏—Ö—Å—è –∑–Ω–∞—á–µ–Ω–∏–π
  for (i in 2:n) {
    s[i] = a0 + a1 * h[i-1] * h[i-1]  # –í—ã—á–∏—Å–ª–µ–Ω–∏–µ –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è –ø—Ä–æ—Ü–µ—Å—Å–∞
    e = rnorm(1, 0, 1)  # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –Ω–æ–≤–æ–π –æ—à–∏–±–∫–∏
    h[i] = e * sqrt(s[i])  # –í—ã—á–∏—Å–ª–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è –ø—Ä–æ—Ü–µ—Å—Å–∞
  }
  
  return(data.frame(s, h))  # –í–æ–∑–≤—Ä–∞—Ç –¥–∞–Ω–Ω—ã—Ö –≤ –≤–∏–¥–µ –¥–∞—Ç–∞—Ñ—Ä–µ–π–º–∞
}

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –¥–ª—è –º–æ–¥–µ–ª–∏ GARCH(1,0)
a0 = 0.4
a1 = 0.5
n = 1000  # –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–∞–±–ª—é–¥–µ–Ω–∏–π

# –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö GARCH(1,0)
reg = garch_1_0(n, a0, a1)

# –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–≥–æ–ª–æ–≤–∫–∞ –¥–ª—è –≥—Ä–∞—Ñ–∏–∫–∞ –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏
title = sprintf("–ì—Ä–∞—Ñ–∏–∫ –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏. –ü–∞—Ä–∞–º–µ—Ç—Ä—ã a0 = %f , a1 = %f  ", a0, a1)
# –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–∞ –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏
plot(reg$s, main = title, type = "l", col = "blue")

# –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–≥–æ–ª–æ–≤–∫–∞ –¥–ª—è –≥—Ä–∞—Ñ–∏–∫–∞ –ø—Ä–æ—Ü–µ—Å—Å–∞
title = sprintf("–ì—Ä–∞—Ñ–∏–∫ –ø—Ä–æ—Ü–µ—Å—Å–∞. –ü–∞—Ä–∞–º–µ—Ç—Ä—ã a0 = %f , a1 = %f  ", a0, a1)
# –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–∞ –ø—Ä–æ—Ü–µ—Å—Å–∞
plot(reg$h, main = title, type = "l", col = "blue")

## 2. –û—Ü–µ–Ω–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã ùëé0 –∏ ùëé1 —Å –ø–æ–º–æ—â—å—é –º–µ—Ç–æ–¥–∞ –Ω–∞–∏–º–µ–Ω—å—à–∏—Ö –∫–≤–∞–¥—Ä–∞—Ç–æ–≤ (–ú–ù–ö),
## –ø—É—Ç–µ–º –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –ø—Ä–æ—Ü–µ—Å—Å–∞ ARCH(1) ‚â° GARCH(1, 0) –∫ –ø—Ä–æ—Ü–µ—Å—Å—É –∞–≤—Ç–æ—Ä–µ–≥—Ä–µ—Å—Å–∏–∏ –ø–µ—Ä–≤–æ–≥–æ –ø–æ—Ä—è–¥–∫–∞.

reg = reg$h  # –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ç–æ–ª—å–∫–æ –∑–Ω–∞—á–µ–Ω–∏–π –ø—Ä–æ—Ü–µ—Å—Å–∞ –¥–ª—è –æ—Ü–µ–Ω–∫–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
sum1 = 0
sum2 = 0
chisl = 0
zn = 0
a1_estimate = 0
a0_estimate = 0

# –í—ã—á–∏—Å–ª–µ–Ω–∏–µ —á–∏—Å–ª–∏—Ç–µ–ª—è –¥–ª—è –æ—Ü–µ–Ω–∫–∏ a1
for (k in 2:n) {
  for (s in 2:n) {
    sum1 = sum1 + (reg[k]^2) * (reg[s-1]^2)  # –°—É–º–º–∞ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–π –∫–≤–∞–¥—Ä–∞—Ç–æ–≤ –∑–Ω–∞—á–µ–Ω–∏–π –ø—Ä–æ—Ü–µ—Å—Å–∞
  }
}

# –í—ã—á–∏—Å–ª–µ–Ω–∏–µ –∑–Ω–∞–º–µ–Ω–∞—Ç–µ–ª—è –¥–ª—è –æ—Ü–µ–Ω–∫–∏ a1
for (k in 2:n) {
  sum2 = sum2 + (reg[k]^2) * (reg[k-1]^2)  # –°—É–º–º–∞ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–π –∫–≤–∞–¥—Ä–∞—Ç–æ–≤ —Ç–µ–∫—É—â–µ–≥–æ –∏ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ –∑–Ω–∞—á–µ–Ω–∏–π
}

chisl = sum1 - n * sum2  # –ß–∏—Å–ª–∏—Ç–µ–ª—å –¥–ª—è –æ—Ü–µ–Ω–∫–∏ a1
sum1 = 0
sum2 = 0

# –í—ã—á–∏—Å–ª–µ–Ω–∏–µ —á–∏—Å–ª–∏—Ç–µ–ª—è –¥–ª—è –∑–Ω–∞–º–µ–Ω–∞—Ç–µ–ª—è
for (k in 2:n) {
  for (s in 2:n) {
    sum1 = sum1 + (reg[k-1]^2) * (reg[s-1]^2)  # –°—É–º–º–∞ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–π –∫–≤–∞–¥—Ä–∞—Ç–æ–≤ –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö –∑–Ω–∞—á–µ–Ω–∏–π
  }
}

# –í—ã—á–∏—Å–ª–µ–Ω–∏–µ –∑–Ω–∞–º–µ–Ω–∞—Ç–µ–ª—è –¥–ª—è –æ—Ü–µ–Ω–∫–∏ a1
for (k in 2:n) {
  sum2 = sum2 + (reg[k-1]^4)  # –°—É–º–º–∞ —á–µ—Ç–≤–µ—Ä—Ç—ã—Ö —Å—Ç–µ–ø–µ–Ω–µ–π –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö –∑–Ω–∞—á–µ–Ω–∏–π
}

zn = sum1 - n * sum2  # –ó–Ω–∞–º–µ–Ω–∞—Ç–µ–ª—å –¥–ª—è –æ—Ü–µ–Ω–∫–∏ a1
a1_estimate = chisl / zn  # –û—Ü–µ–Ω–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ a1

# –°–±—Ä–æ—Å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –¥–ª—è –æ—Ü–µ–Ω–∫–∏ a0
sum1 = 0
chisl = 0
zn = 0

# –í—ã—á–∏—Å–ª–µ–Ω–∏–µ —á–∏—Å–ª–∏—Ç–µ–ª—è –¥–ª—è –æ—Ü–µ–Ω–∫–∏ a0
for (k in 2:n) {
  sum1 = sum1 + (reg[k-1]^2) * (reg[k]^2)  # –°—É–º–º–∞ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–π –∫–≤–∞–¥—Ä–∞—Ç–æ–≤ —Ç–µ–∫—É—â–∏—Ö –∏ –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö –∑–Ω–∞—á–µ–Ω–∏–π
}

chisl = sum1 - a1_estimate * sum2  # –ß–∏—Å–ª–∏—Ç–µ–ª—å –¥–ª—è –æ—Ü–µ–Ω–∫–∏ a0
sum1 = 0

# –í—ã—á–∏—Å–ª–µ–Ω–∏–µ –∑–Ω–∞–º–µ–Ω–∞—Ç–µ–ª—è –¥–ª—è –æ—Ü–µ–Ω–∫–∏ a0
for (k in 2:n) {
  sum1 = sum1 + (reg[k-1]^2)  # –°—É–º–º–∞ –∫–≤–∞–¥—Ä–∞—Ç–æ–≤ –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö –∑–Ω–∞—á–µ–Ω–∏–π
}

zn = sum2  # –ó–Ω–∞–º–µ–Ω–∞—Ç–µ–ª—å –¥–ª—è –æ—Ü–µ–Ω–∫–∏ a0
a0_estimate = chisl / zn  # –û—Ü–µ–Ω–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ a0

# –í—ã–≤–æ–¥ –æ—Ü–µ–Ω–æ–∫ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ a0 –∏ a1
print("–û—Ü–µ–Ω–∫–∞ –∞0:")
a0_estimate
print("–û—Ü–µ–Ω–∫–∞ –∞1:")
a1_estimate

## 3. –û—Ü–µ–Ω–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã ùëé0, ùëé1 –ø—Ä–∏ –ø–æ–º–æ—â–∏ —Ñ—É–Ω–∫—Ü–∏–∏ garch() –ø–∞–∫–µ—Ç–∞ tseries –ø–æ –≤—ã–±–æ—Ä–∫–µ {‚Ñéùëõ}.

garch(reg, order = c(1, 0))  # –û—Ü–µ–Ω–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –º–æ–¥–µ–ª–∏ GARCH(1,0) —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Ñ—É–Ω–∫—Ü–∏–∏ garch()

## 4. –ü–æ—Å—Ç—Ä–æ–∏—Ç—å –≥—Ä–∞—Ñ–∏–∫ —Å—Ç–∞—Ü–∏–æ–Ω–∞—Ä–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞ GARCH(3,0) –∏–∑ n = 1100 –Ω–∞–±–ª—é–¥–µ–Ω–∏–π.

# –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ GARCH(3,0) –ø—Ä–æ—Ü–µ—Å—Å–∞
garch_3_0 <- function(n, a0, a1, a2, a3) {
  s = numeric(n)  # –í–µ–∫—Ç–æ—Ä –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –∑–Ω–∞—á–µ–Ω–∏–π –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏
  h = numeric(n)  # –í–µ–∫—Ç–æ—Ä –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –∑–Ω–∞—á–µ–Ω–∏–π –ø—Ä–æ—Ü–µ—Å—Å–∞
  s[1] = runif(1, min = 0, max = 1)  # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø–µ—Ä–≤–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏
  e = rnorm(1, 0, 1)  # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø–µ—Ä–≤–æ–π –æ—à–∏–±–∫–∏
  h[1] = e * sqrt(s[1])  # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø–µ—Ä–≤–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è –ø—Ä–æ—Ü–µ—Å—Å–∞
  
  # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –≤—Ç–æ—Ä–æ–≥–æ –∏ —Ç—Ä–µ—Ç—å–µ–≥–æ –∑–Ω–∞—á–µ–Ω–∏–π
  s[2] = a0 + a1 * h[1] * h[1]  # –í—Ç–æ—Ä–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏
  e = rnorm(1, 0, 1)  # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –Ω–æ–≤–æ–π –æ—à–∏–±–∫–∏
  h[2] = e * sqrt(s[2])  # –í—Ç–æ—Ä–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–∞
  
  s[3] = a0 + a1 * h[2] * h[2] + a2 * h[1] * h[1]  # –¢—Ä–µ—Ç—å–µ –∑–Ω–∞—á–µ–Ω–∏–µ –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏
  e = rnorm(1, 0, 1)  # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –Ω–æ–≤–æ–π –æ—à–∏–±–∫–∏
  h[3] = e * sqrt(s[3])  # –¢—Ä–µ—Ç—å–µ –∑–Ω–∞—á–µ–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–∞
  
  # –¶–∏–∫–ª –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –æ—Å—Ç–∞–≤—à–∏—Ö—Å—è –∑–Ω–∞—á–µ–Ω–∏–π
  for (i in 4:n) {
    s[i] = a0 + a1 * h[i-1] * h[i-1] + a2 * h[i-2] * h[i-2] + a3 * h[i-3] * h[i-3]  # –í—ã—á–∏—Å–ª–µ–Ω–∏–µ –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏
    e = rnorm(1, 0, 1)  # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –Ω–æ–≤–æ–π –æ—à–∏–±–∫–∏
    h[i] = e * sqrt(s[i])  # –í—ã—á–∏—Å–ª–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è –ø—Ä–æ—Ü–µ—Å—Å–∞
  }
  
  return(h)  # –í–æ–∑–≤—Ä–∞—Ç –∑–Ω–∞—á–µ–Ω–∏–π –ø—Ä–æ—Ü–µ—Å—Å–∞
}

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –¥–ª—è –º–æ–¥–µ–ª–∏ GARCH(3,0)
a0 = 0.2
a1 = 0.3
a2 = 0.1
a3 = 0.4

# –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö GARCH(3,0)
reg = garch_3_0(1100, a0, a1, a2, a3)

# –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–≥–æ–ª–æ–≤–∫–∞ –¥–ª—è –≥—Ä–∞—Ñ–∏–∫–∞ –ø—Ä–æ—Ü–µ—Å—Å–∞
title = sprintf("–ì—Ä–∞—Ñ–∏–∫ –ø—Ä–æ—Ü–µ—Å—Å–∞. –ü–∞—Ä–∞–º–µ—Ç—Ä—ã a0 = %f , a1 = %f, a2 = %f , a3 = %f  ", a0, a1, a2, a3)
# –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–∞ –ø—Ä–æ—Ü–µ—Å—Å–∞
plot(reg, main = title, type = "l", col = "blue")

# –û—Ü–µ–Ω–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –º–æ–¥–µ–ª–∏ GARCH(3,0) —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Ñ—É–Ω–∫—Ü–∏–∏ garch()
garch(reg, order = c(3, 0), start = c(a0, a1, a2, a3))$coef

## –ó–∞–¥–∞–Ω–∏–µ ‚Ññ5 ----
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –¥–ª—è –º–æ–¥–µ–ª–∏ GARCH(1,1)
a0 = 0.1
a1 = 0.2
b1 = 0.4

# –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ GARCH(1,1) –ø—Ä–æ—Ü–µ—Å—Å–∞
garch_1_1 <- function(n, a0, a1, b1) {
  s = numeric(n)  # –í–µ–∫—Ç–æ—Ä –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –∑–Ω–∞—á–µ–Ω–∏–π –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏
  h = numeric(n)  # –í–µ–∫—Ç–æ—Ä –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –∑–Ω–∞—á–µ–Ω–∏–π –ø—Ä–æ—Ü–µ—Å—Å–∞
  e = rnorm(1, 0, 1)  # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø–µ—Ä–≤–æ–π –æ—à–∏–±–∫–∏
  s[1] = runif(1, min = 0, max = 1)  # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø–µ—Ä–≤–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏
  h[1] = e * sqrt(s[1])  # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø–µ—Ä–≤–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è –ø—Ä–æ—Ü–µ—Å—Å–∞
  
  # –¶–∏–∫–ª –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –æ—Å—Ç–∞–≤—à–∏—Ö—Å—è –∑–Ω–∞—á–µ–Ω–∏–π
  for (i in 2:n) {
    s[i] = a0 + a1 * h[i-1] * h[i-1] + b1 * s[i-1] * s[i-1]  # –í—ã—á–∏—Å–ª–µ–Ω–∏–µ –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏
    e = rnorm(1, 0, 1)  # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –Ω–æ–≤–æ–π –æ—à–∏–±–∫–∏
    h[i] = e * sqrt(s[i])  # –í—ã—á–∏—Å–ª–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è –ø—Ä–æ—Ü–µ—Å—Å–∞
  }
  
  return(data.frame(s, h))  # –í–æ–∑–≤—Ä–∞—Ç –¥–∞–Ω–Ω—ã—Ö –≤ –≤–∏–¥–µ –¥–∞—Ç–∞—Ñ—Ä–µ–π–º–∞
}

# –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö GARCH(1,1)
reg = garch_1_1(1000, a0, a1, b1)

# –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–≥–æ–ª–æ–≤–∫–∞ –¥–ª—è –≥—Ä–∞—Ñ–∏–∫–∞ –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏
title = sprintf("–ì—Ä–∞—Ñ–∏–∫ –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏. –ü–∞—Ä–∞–º–µ—Ç—Ä—ã a0 = %f , a1 = %f, b1 = %f ", a0, a1, b1)
# –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–∞ –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏
plot(reg$s, main = title, type = "l", col = "blue")

# –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–≥–æ–ª–æ–≤–∫–∞ –¥–ª—è –≥—Ä–∞—Ñ–∏–∫–∞ –ø—Ä–æ—Ü–µ—Å—Å–∞
title = sprintf("–ì—Ä–∞—Ñ–∏–∫ –ø—Ä–æ—Ü–µ—Å—Å–∞. –ü–∞—Ä–∞–º–µ—Ç—Ä—ã a0 = %f , a1 = %f, b1 = %f  ", a0, a1, b1)
# –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–∞ –ø—Ä–æ—Ü–µ—Å—Å–∞
plot(reg$h, main = title, type = "l", col = "blue")

# –û—Ü–µ–Ω–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –º–æ–¥–µ–ª–∏ GARCH(1,1) —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Ñ—É–Ω–∫—Ü–∏–∏ garch()
garch(reg$h, order = c(1, 1), start = c(a0, a1, b1))