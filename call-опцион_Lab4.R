#4 –õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞—è —Ä–∞–±–æ—Ç–∞: call-–æ–ø—Ü–∏–æ–Ω

## 1. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å {ùêµùëõ} –¥–ª—è –∑–∞–¥–∞–Ω–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è —Å—Ç–∞–≤–∫–∏ ùëü = 0.01,
## –∏—Å–ø–æ–ª—å–∑—É—è —Ñ–æ—Ä–º—É–ª—É (5), –∑–∞ –ø–µ—Ä–∏–æ–¥ ùëÅ = 200 –ø—Ä–∏ ùêµ0 = 1. –ü–æ—Å—Ç—Ä–æ–∏—Ç—å –≥—Ä–∞—Ñ–∏–∫.

n = 200               # –ó–∞–¥–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–µ—Ä–∏–æ–¥–æ–≤ (N)
r = 0.01              # –ó–∞–¥–∞–µ–º —Å—Ç–∞–≤–∫—É (r)
B = numeric(n)       # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –≤–µ–∫—Ç–æ—Ä B –¥–ª–∏–Ω–æ–π n, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç —Ö—Ä–∞–Ω–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
B[1] = 1              # –ù–∞—á–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ B0 = 1

# –¶–∏–∫–ª –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ Bn
for (i in 2:n) {     
  B[i] = (1 + r) * B[i - 1]  # –í—ã—á–∏—Å–ª—è–µ–º —Ç–µ–∫—É—â–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ Bn –ø–æ —Ñ–æ—Ä–º—É–ª–µ
}

plot(B, type = "l", col = "blue")  # –°—Ç—Ä–æ–∏–º –≥—Ä–∞—Ñ–∏–∫ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ Bn

## 2. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Å–ª—É—á–∞–π–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å {ùëÜùëõ}, –∏—Å–ø–æ–ª—å–∑—É—è —Ñ–æ—Ä–º—É–ª—É (5),
## –ø—Ä–∏ —Å–ª–µ–¥—É—é—â–∏—Ö –∑–Ω–∞—á–µ–Ω–∏—è—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤: ùëÜ0 = 1, ùëÅ = 200, ùëé = ‚àí0.3, ùëè = 0.8, ùëù = 0.4. –ü–æ—Å—Ç—Ä–æ–∏—Ç—å –≥—Ä–∞—Ñ–∏–∫.

a = -0.3              # –ó–∞–¥–∞–µ–º –∑–Ω–∞—á–µ–Ω–∏–µ a
b = 0.8               # –ó–∞–¥–∞–µ–º –∑–Ω–∞—á–µ–Ω–∏–µ b
p = 0.4               # –ó–∞–¥–∞–µ–º –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å p
S = numeric(n)       # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –≤–µ–∫—Ç–æ—Ä S –¥–ª–∏–Ω–æ–π n –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –∑–Ω–∞—á–µ–Ω–∏–π —Å–ª—É—á–∞–π–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞
S[1] = 1              # –ù–∞—á–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ S0 = 1

# –¶–∏–∫–ª –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ —Å–ª—É—á–∞–π–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞ Sn
for (i in 2:n) {     
  bern_sv = rbinom(1, 1, p)  # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Å–ª—É—á–∞–π–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –∏–∑ –±–∏–Ω–æ–º–∏–∞–ª—å–Ω–æ–≥–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è
  if (bern_sv == 1) {        # –ï—Å–ª–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Ä–∞–≤–µ–Ω 1
    bern_sv = b              # –ü—Ä–∏—Å–≤–∞–∏–≤–∞–µ–º –∑–Ω–∞—á–µ–Ω–∏–µ b
  } else {                   # –ï—Å–ª–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Ä–∞–≤–µ–Ω 0
    bern_sv = a              # –ü—Ä–∏—Å–≤–∞–∏–≤–∞–µ–º –∑–Ω–∞—á–µ–Ω–∏–µ a
  }
  S[i] = (1 + bern_sv) * S[i - 1]  # –í—ã—á–∏—Å–ª—è–µ–º —Ç–µ–∫—É—â–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ Sn –ø–æ —Ñ–æ—Ä–º—É–ª–µ
}

plot(S, type = "l", col = "blue")  # –°—Ç—Ä–æ–∏–º –≥—Ä–∞—Ñ–∏–∫ —Å–ª—É—á–∞–π–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞ Sn

## 3. –†–∞—Å—Å—á–∏—Ç–∞—Ç—å —Å–ø—Ä–∞–≤–µ–¥–ª–∏–≤—É—é —Ü–µ–Ω—É ùëêùëéùëôùëô-–æ–ø—Ü–∏–æ–Ω–∞ –ø–æ —Ñ–æ—Ä–º—É–ª–µ (7)
## –ø—Ä–∏ —Å–ª–µ–¥—É—é—â–∏—Ö –∑–Ω–∞—á–µ–Ω–∏—è—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤: ùëÜ0 = 100, ùëÅ = 10, ùëé = ‚àí0.3, ùëè = 0.8, ùëü = 0.2, ùêæ = 100.

n = 10                # –ó–∞–¥–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–µ—Ä–∏–æ–¥–æ–≤ (N)
a = -0.3             # –ó–∞–¥–∞–µ–º –∑–Ω–∞—á–µ–Ω–∏–µ a
b = 0.8              # –ó–∞–¥–∞–µ–º –∑–Ω–∞—á–µ–Ω–∏–µ b
r = 0.2               # –ó–∞–¥–∞–µ–º —Å—Ç–∞–≤–∫—É (r)
K = 100               # –ó–∞–¥–∞–µ–º —Å—Ç—Ä–∞–π–∫ (K)
S0 = 100              # –ù–∞—á–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ S0

# –í—ã—á–∏—Å–ª—è–µ–º –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏
p_1 = (r - a) / (b - a)  # –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å —É—Å–ø–µ—Ö–∞ –¥–ª—è –ø–µ—Ä–≤–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞
p_2 = ((1 + b) / (1 + r)) * p_1  # –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å —É—Å–ø–µ—Ö–∞ –¥–ª—è –≤—Ç–æ—Ä–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞

# –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º K0 –ø–æ —Ñ–æ—Ä–º—É–ª–µ
K0 = 1 + (log(K / (S0 * (1 + a)^n))) * (log((1 + b) / (1 + a)))^(-1)

B1 = 0                 # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –¥–ª—è –ø–µ—Ä–≤–æ–π —Å—É–º–º—ã
B2 = 0                 # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –¥–ª—è –≤—Ç–æ—Ä–æ–π —Å—É–º–º—ã

# –¶–∏–∫–ª –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ B1 –∏ B2
for (k in K0:n) {     
  B1 = B1 + (factorial(n) / (factorial(k) * factorial(n - k))) * (p_1^k) * (1 - p_1)^(n - k)  # –°—É–º–º–∞ –¥–ª—è B1
  B2 = B2 + (factorial(n) / (factorial(k) * factorial(n - k))) * (p_2^k) * (1 - p_2)^(n - k)  # –°—É–º–º–∞ –¥–ª—è B2
}

# –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º —Å–ø—Ä–∞–≤–µ–¥–ª–∏–≤—É—é —Ü–µ–Ω—É call-–æ–ø—Ü–∏–æ–Ω–∞
C = S0 * B2 - K * (1 + r)^(-n) * B1  # –§–æ—Ä–º—É–ª–∞ –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ —Ü–µ–Ω—ã call-–æ–ø—Ü–∏–æ–Ω–∞
C  # –í—ã–≤–æ–¥–∏–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç

